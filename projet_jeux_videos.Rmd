# Projet Video Games

## ACP

### Analyse des données

```{r}
jeu_donnees = read.csv("Video_Games_Sales_as_at_22_Dec_2016.csv")
jeu_donnees <- na.omit(jeu_donnees) # on enlève les "NA"
jeu_donnees$NA_Sales <- as.numeric(jeu_donnees$NA_Sales)
jeu_donnees$User_Score <- as.numeric(jeu_donnees$User_Score)
jeu_donnees$Year_of_Release <- as.numeric(jeu_donnees$Year_of_Release)
head(jeu_donnees)
```

```{r}
summary(jeu_donnees)
```

```{r}
sales_data = jeu_donnees[, c("NA_Sales", "EU_Sales", "JP_Sales", "Other_Sales")]
boxplot(sales_data)
```

```{r}
boxplot(sales_data, ylim = c(0, 0.5))
```

```{r}
# trop de jeux à faible ventes, en particulier au Japon
jeu_donnees_top <- jeu_donnees[jeu_donnees$Global_Sales >= 5.0,]
sales_data_top = jeu_donnees_top[, c("NA_Sales", "EU_Sales", "JP_Sales", "Other_Sales")]
boxplot(sales_data_top, ylim = c(0, 10))
```

```{r}
pairs(sales_data_top)
#on voit pas bien s'il y a une droite, et donc les corrélations entre ces 4 données
# je pense il faudrait qu'on garde qu'une catégorie pour qu'il y ait moins de données comme vu en TP pour mieux voir (on pourrait garder les jeux d'un seul développeur par exemple)
```

```{r}
cov(sales_data)
```

### Qualité de la représentation d’un individu

```{r}
# A VOIR SI ON REDUIT LE NOMBRE DE DONNEES (l'idéal serait ensuite dans le cas ou on a toujours trop de données, de séparer les valeurs en différentes catégories, par ex, celles entre 0.75 et 1, 0.5 et 0.75, 0.25 et 0.5, 0 et 0.25)
```

### Contribution d’un individu à un axe

```{r}
# pareil
```

## ACP avec FactoMineR

### On refait avec toutes les variables quantitatives

```{r}
library(FactoMineR)
```

```{r}
var_tot <- jeu_donnees[, c("Year_of_Release","NA_Sales", "EU_Sales", "JP_Sales", "Other_Sales","Critic_Score","Critic_Count","User_Score","User_Count")]
res <- PCA(sales_data) # scale.unit = TRUE pour des variables centrées réduites
res
res1 <- PCA(var_tot)
res1
var_avis <- jeu_donnees[, c("Critic_Score","Critic_Count","User_Score","User_Count")]
res2 <- PCA(var_avis)
res2
#les variables sont globalement bien représentées pour res et res2 mais pas res1
#pour les individus, la majorité d'entre eux sont mal représentés (trop proche de 0)
```

```{r}
var_tot_top <- jeu_donnees_top[, c("Year_of_Release","NA_Sales", "EU_Sales", "JP_Sales", "Other_Sales","Critic_Score","Critic_Count","User_Score","User_Count")]
res <- PCA(sales_data_top) # scale.unit = TRUE pour des variables centrées réduites
res
res1 <- PCA(var_tot_top)
res1
var_avis_top <- jeu_donnees_top[, c("Critic_Score","Critic_Count","User_Score","User_Count")]
res2 <- PCA(var_avis_top)
res2
#les variables sont globalement bien représentées pour res et res2 mais pas res1
#pour les individus, la majorité d'entre eux sont mal représentés (trop proche de 0)
```

### Avec res

```{r}
res$eig
barplot(res$eig[,2])
```

```{r}
plot(res, choix="ind")
plot(res, choix="ind", axes=c(1,3))
# on voit tellement rien (à part peut-etre que pour le 2eme graphe, c'est plus "aplati", ce qui signifie que la dimension 3 explique moins)
```

#### Les contributions les plus élevées

```{r}
# Plus concret
#head(res$ind$cos2)
cos2_dim1 <- res$ind$cos2[, "Dim.1"]  # Extraire uniquement Dim.1
cos2_dim2 <- res$ind$cos2[, "Dim.2"]  # Extraire uniquement Dim.2
cos2_sum <- cos2_dim1 + cos2_dim2
sorted_cos2 <- sort(cos2_sum, decreasing = TRUE)  # Trier en ordre décroissant
head(sorted_cos2, n=200L)
#res$ind$cos2[order(res$ind$cos2$Dim.1), ][1:5, ]
#jeu_donnees[order(-jeu_donnees$colonneX), ][1:5, ]
```

```{r}
plot(res, select="contrib 5", choix="ind")
```

```{r}
plot(res, select="cos2 0.999", choix="ind") # on voit rien
```

### Avec res2

```{r}
res2$eig
barplot(res2$eig[,2])
```

```{r}
res2$var$contrib
```

```{r}
res2$var$cos2
```

Il faudrait surement 3 dimensions. Y-a-t-il un lien avec le rating (correspondant à l'age minimal conseillé pour le jeu) ?

```{r}
#jeu_donnees$Rating <- droplevels(jeu_donnees$Rating)
jeu_donnees_top$Rating[jeu_donnees_top$Rating == ""] <- "NoRating"
jeu_donnees_top$Rating <- as.factor(jeu_donnees_top$Rating)  # Reconversion en facteur
levels(jeu_donnees_top$Rating)
var_avis1 <- jeu_donnees_top[, c("Critic_Score","Critic_Count","User_Score","User_Count","Rating")]
head(var_avis1)
res2_1 <- PCA(var_avis1, quali.sup = 5)
#head(res2_1)
#jeu_donnees$Rating <- as.factor(jeu_donnees$Rating)
```

```{r}

plot.PCA(res2_1, select = "cos2 0.8", habillage = 5)
#head(res2_1)
# On voit vraiment rien !
```

### Tri par éditeur

```{r}
library(ggplot2)
library(dplyr)

sales_dev  <- jeu_donnees_top %>% group_by(Publisher) %>% 
  summarise(Number_of_Games=n(), Mean_Year_of_Release = mean(Year_of_Release), Mean_NA_Sales = mean(NA_Sales), Mean_EU_Sales = mean(EU_Sales), Mean_JP_Sales = mean(JP_Sales), Mean_Global_Sales = mean(Global_Sales), Mean_Critic_Score = mean(Critic_Score), Mean_User_Score = mean(User_Score))
sales_dev %>% arrange(desc(Mean_User_Score))
```

```{r}
res_dev <- PCA(sales_dev,quali.sup = 1,scale.unit = TRUE)
res_dev
```

```{r}
res_dev$eig
res_dev$var$contrib
plot(res_dev, choix="ind")
plot(res_dev, choix="ind", axes=c(1,3))
```

```{r}
sales_dev_2  <- jeu_donnees_top %>% group_by(Publisher) %>% 
  summarise(Mean_NA_Sales = mean(NA_Sales), Mean_EU_Sales = mean(EU_Sales), Mean_JP_Sales = mean(JP_Sales), Mean_Global_Sales = mean(Global_Sales), Mean_Critic_Score = mean(Critic_Score), Mean_User_Score = mean(User_Score))
sales_dev_2 %>% arrange(desc(Mean_Global_Sales))
```

```{r}
res_dev_2 <- PCA(sales_dev_2,quali.sup = 1,scale.unit = TRUE)
res_dev_2
```

```{r}
res_dev_2$eig
res_dev_2$var$contrib
plot(res_dev_2, choix="ind")
plot(res_dev_2, choix="ind", axes=c(1,3))
```
