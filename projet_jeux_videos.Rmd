# Projet Video Games

## ACP

### Analyse des données

```{r}
jeu_donnees = read.csv("Video_Games_Sales_as_at_22_Dec_2016.csv")
jeu_donnees <- na.omit(jeu_donnees) # on enlève les "NA"
head(jeu_donnees)
```

```{r}
summary(jeu_donnees)
```

```{r}
sales_data = jeu_donnees[, c("NA_Sales", "EU_Sales", "JP_Sales", "Other_Sales")]
boxplot(sales_data)
```

```{r}
boxplot(sales_data, ylim = c(0, 0.5))
```

```{r}
pairs(sales_data)
#on voit pas bien s'il y a une droite, et donc les corrélations entre ces 4 données
# je pense il faudrait qu'on garde qu'une catégorie pour qu'il y ait moins de données comme vu en TP pour mieux voir (on pourrait garder les jeux d'un seul développeur par exemple)
```

```{r}
cov(sales_data)
```

```{r}
taille = dim(sales_data)[1]
taille
cov(sales_data)*(taille-1)/taille
# mini-corrélation entre NA et EU ?
```

### Centrer à la main

```{r}
p=4
n=taille
X1= matrix(NA, ncol=p, nrow = n) 
for (j in 1:p) { X1[,j]=(sales_data[,j] - mean(sales_data[,j])) / (sd(sales_data[,j]) * sqrt((n-1)/n)) }
#X1

test1 <- scale(sales_data)
#test1
```

```{r}
S = (n - 1)/n * cov(X1)
cov(X1)
S
eigen(S) #$values,$vectors
```

```{r}
lambda = eigen(S)$values
It <- sum(lambda)
It
It1 <- sum(diag(S))
It1
# logique vu que c'est normal centré donc It1 = It = p = 4
part.inertie = lambda/sum(lambda)
part.inertie
barplot(part.inertie)
# 0.18 bon ca reste ok mais pas 0.08 on garde 2 axes.
```

### Représentation des jeux dans le premier plan principal

```{r}
vecteurs_propres = eigen(S)$vectors
F12 = X1 %*% vecteurs_propres[,1:2] 
#colnames(F12) = paste("Dim", 1:2) 
#plot(F12,xlab='Dim1',ylab='Dim2', xlim=c(-4,4), ylim=c(-2,2), type="n") 
#text(F12,labels=row.names(notes),cex=1.5)
#title(main="représentation des ndividus") 
#abline(h=0) 
#abline(v=0)
```

### Représentation des variables

```{r}
cercle_correlation=cor(X1,F12) 
a=seq(0,2* pi,length=100) 
plot(cos(a), sin(a), type='l',lty=3,xlab='Dim 1', ylab='Dim 2',main="Cercle des corrélations" ) 
arrows(0,0,cercle_correlation[,1],cercle_correlation[,2],col=2) 
text(cercle_correlation,labels=colnames(sales_data))
# Cela confirme notre théorie : Les ventes en Europe et en Amérique du Nord sont corrélées.
```

### Qualité de la représentation d’un individu

```{r}
# A VOIR SI ON REDUIT LE NOMBRE DE DONNEES (l'idéal serait ensuite dans le cas ou on a toujours trop de données, de séparer les valeurs en différentes catégories, par ex, celles entre 0.75 et 1, 0.5 et 0.75, 0.25 et 0.5, 0 et 0.25)
```

### Contribution d’un individu à un axe

```{r}
# pareil
```

## ACP avec FactoMineR

### On refait avec toutes les variables quantitatives

```{r}
library(FactoMineR)
```

```{r}
#jeu_donnees$User_Score = as.factor(jeu_donnees$User_Score)
#jeu_donnees$Rating <- as.factor(jeu_donnees$Rating)
jeu_donnees$User_Score <- as.numeric(jeu_donnees$User_Score)
var_tot <- jeu_donnees[, c("NA_Sales", "EU_Sales", "JP_Sales", "Other_Sales","Critic_Score","Critic_Count","User_Score","User_Count")]
res <- PCA(sales_data) # scale.unit = TRUE pour des variables centrées réduites
res
res1 <- PCA(var_tot)
res1
var_avis <- jeu_donnees[, c("Critic_Score","Critic_Count","User_Score","User_Count")]
res2 <- PCA(var_avis)
res2
#les variables sont globalement bien représentées pour res et res2 mais pas res1
#pour les individus, la majorité d'entre eux sont mal représentés (trop proche de 0)
```

### Avec res

```{r}
res$eig
barplot(res$eig[,2])
```

```{r}
plot(res, choix="ind")
plot(res, choix="ind", axes=c(1,3))
# on voit tellement rien (à part peut-etre que pour le 2eme graphe, c'est plus "aplati", ce qui signifie que la dimension 3 explique moins)
```

#### Les contributions les plus élevées

```{r}
# Plus concret
#head(res$ind$cos2)
cos2_dim1 <- res$ind$cos2[, "Dim.1"]  # Extraire uniquement Dim.1
cos2_dim2 <- res$ind$cos2[, "Dim.2"]  # Extraire uniquement Dim.2
cos2_sum <- cos2_dim1 + cos2_dim2
sorted_cos2 <- sort(cos2_sum, decreasing = TRUE)  # Trier en ordre décroissant
head(sorted_cos2, n=200L)
#res$ind$cos2[order(res$ind$cos2$Dim.1), ][1:5, ]
#jeu_donnees[order(-jeu_donnees$colonneX), ][1:5, ]
```

```{r}
plot(res, select="contrib 5", choix="ind")
```

```{r}
plot(res, select="cos2 0.999", choix="ind") # on voit rien
```

### Avec res2

```{r}
res2$eig
barplot(res2$eig[,2])
```

```{r}
res2$var$contrib
```

```{r}
res2$var$cos2
```

Il faudrait surement 3 dimensions. Y-a-t-il un lien avec le rating (correspondant à l'age minimal conseillé pour le jeu) ?

```{r}
#jeu_donnees$Rating <- droplevels(jeu_donnees$Rating)
jeu_donnees$Rating[jeu_donnees$Rating == ""] <- "NoRating"
jeu_donnees$Rating <- as.factor(jeu_donnees$Rating)  # Reconversion en facteur
levels(jeu_donnees$Rating)
var_avis1 <- jeu_donnees[, c("Critic_Score","Critic_Count","User_Score","User_Count","Rating")]
head(var_avis1)
res2_1 <- PCA(var_avis1, quali.sup = 5)
#head(res2_1)
#jeu_donnees$Rating <- as.factor(jeu_donnees$Rating)
```

```{r}

plot.PCA(res2_1, select = "cos2 0.8", habillage = 5)
#head(res2_1)
```
